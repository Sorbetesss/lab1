---------------------------------------------------------------------------

by nicolas-grekas at 2018-10-21T14:35:36Z

PR rebased and comments addressed, ready.
