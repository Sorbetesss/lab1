---------------------------------------------------------------------------

by xabbuh at 2019-07-11T12:42:31Z

same as #32249 and #32250 but with tests introduced in #31511
