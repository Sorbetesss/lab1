---------------------------------------------------------------------------

by yceruto at 2020-01-26T20:49:11Z

@nicolas-grekas I've simplied it a bit more.
It should be ready now.
