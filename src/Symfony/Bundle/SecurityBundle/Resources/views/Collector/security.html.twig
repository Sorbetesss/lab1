{% extends '@WebProfiler/Profiler/layout.html.twig' %}

{% block toolbar %}
    {% if collector.user %}
        {% set color_code = (collector.enabled and collector.authenticated) ? 'green' : 'yellow'  %}
        {% set authentication_color_code = (collector.enabled and collector.authenticated) ? 'green' : 'red'  %}
        {% set authentication_color_text = (collector.enabled and collector.authenticated) ? 'Yes' : 'No'  %}
    {% else %}
        {% set color_code = collector.enabled ? 'red' : 'black'  %}
    {% endif %}
    {% set text %}
        {% if collector.user %}
            <div class="sf-toolbar-info-piece">
                <b>Logged in as</b>
                <span class="sf-toolbar-status sf-toolbar-status-{{ color_code }}">{{ collector.user }}</span>
            </div>
            <div class="sf-toolbar-info-piece">
                <b>Authenticated</b>
                <span class="sf-toolbar-status sf-toolbar-status-{{ authentication_color_code }}">{{ authentication_color_text }}</span>
            </div>
            {% if collector.tokenClass != null %}
            <div class="sf-toolbar-info-piece">
                <b>Token class</b>
                {{ collector.tokenClass|abbr_class }}
            </div>
            {% endif %}
        {% elseif collector.enabled %}
            You are not authenticated.
        {% else %}
            The security is disabled.
        {% endif %}
    {% endset %}
    {% set icon %}
        <img width="24" height="28" alt="Security" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMjQgMjgiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48Zz48cGF0aCBmaWxsPSIjM0YzRjNGIiBkPSJNOC42IDE0LjZjMC0wLjQgMC0wLjYgMC0wLjljMC4yLTAuMSAwLjUtMC42IDAuNS0xLjFjMC4xIDAgMC4zLTAuMSAwLjQtMC42YzAtMC4zLTAuMS0wLjQtMC4yLTAuNSBjMC4yLTAuNiAwLjYtMi42LTAuOC0yLjhDOC40IDguNCA4IDguMyA3LjUgOC4zYy0yIDAtMi4yIDEuNS0xLjggMy4yYy0wLjEgMC0wLjIgMC4yLTAuMiAwLjVjMC4xIDAuNSAwLjMgMC42IDAuNCAwLjYgYzAgMC41IDAuNCAxIDAuNSAxLjFjMCAwLjMgMCAwLjYgMCAwLjljLTAuNCAxLjEtMyAwLjgtMy4yIDIuOGg4LjVDMTEuNyAxNS4zIDkgMTUuNiA4LjYgMTQuNnoiLz48cGF0aCBmaWxsPSIjM0YzRjNGIiBkPSJNMTggMTAuN2MtMC4yIDAtMC40IDAtMC41IDAuMWMtMC4yIDAuMS0wLjMgMC4yLTAuNSAwLjVjLTAuMiAwLjItMC4zIDAuNS0wLjQgMC44cy0wLjEgMC42LTAuMSAwLjggYzAgMC40IDAuMSAwLjcgMC4zIDAuOWMwLjIgMC4yIDAuNCAwLjMgMC42IDAuM2MwLjIgMCAwLjMgMCAwLjUtMC4xYzAuMi0wLjEgMC4zLTAuMiAwLjUtMC40YzAuMi0wLjIgMC4zLTAuNCAwLjQtMC43IGMwLjEtMC4zIDAuMi0wLjYgMC4yLTAuOWMwLTAuNC0wLjEtMC43LTAuMy0wLjlDMTguNSAxMC44IDE4LjIgMTAuNyAxOCAxMC43eiIvPjxwYXRoIGZpbGw9IiMzRjNGM0YiIGQ9Ik0yMi4yIDZIMS44QzEuMyA2IDEgNi4zIDEgNi44djE0LjRjMCAwLjQgMC4zIDAuOCAwLjggMC44aDMuOHYtMC44Yy0wLjQgMC0wLjgtMC4zLTAuOC0wLjggYzAtMC40IDAuMy0wLjggMC44LTAuOGgxLjVjMC40IDAgMC44IDAuMyAwLjggMC44YzAgMC40LTAuMyAwLjgtMC44IDAuOHYwLjhoOS45di0wLjhjLTAuNCAwLTAuOC0wLjMtMC44LTAuOCBjMC0wLjQgMC4zLTAuOCAwLjgtMC44aDEuNWMwLjQgMCAwLjggMC4zIDAuOCAwLjhjMCAwLjQtMC4zIDAuOC0wLjggMC44djAuOGgzLjhjMC40IDAgMC44LTAuMyAwLjgtMC44VjYuOEMyMyA2LjMgMjIuNyA2IDIyLjIgNnogTTEyLjQgMTcuNGMwIDAuNC0wLjMgMC44LTAuOCAwLjhIMy4zYy0wLjQgMC0wLjgtMC4zLTAuOC0wLjhWOC4zYzAtMC40IDAuMy0wLjggMC44LTAuOGg4LjNjMC40IDAgMC44IDAuMyAwLjggMC44VjE3LjR6IE0yMS40IDE1LjZjLTAuNCAwLjMtMC44IDAuNi0xLjMgMC43Yy0wLjUgMC4yLTEuMSAwLjMtMS44IDAuM2MtMC42IDAtMS4yLTAuMS0xLjgtMC4yYy0wLjUtMC4yLTEtMC40LTEuNC0wLjcgYy0wLjQtMC4zLTAuNy0wLjctMC45LTEuMWMtMC4yLTAuNS0wLjQtMS4xLTAuNC0xLjhjMC0wLjcgMC4xLTEuNCAwLjQtMmMwLjQtMC44IDAuOS0xLjQgMS41LTEuOGMwLjYtMC40IDEuNC0wLjYgMi40LTAuNiBjMC43IDAgMS40IDAuMSAxLjkgMC40YzAuNiAwLjMgMSAwLjcgMS4zIDEuM2MwLjMgMC41IDAuNCAxIDAuNCAxLjZjMCAwLjgtMC4zIDEuNi0wLjkgMi4yYy0wLjUgMC42LTEuMSAwLjktMS43IDAuOSBjLTAuMiAwLTAuNCAwLTAuNS0wLjFjLTAuMS0wLjEtMC4yLTAuMS0wLjMtMC4zYzAtMC4xLTAuMS0wLjItMC4xLTAuNGMtMC4yIDAuMi0wLjQgMC40LTAuNiAwLjVjLTAuMiAwLjEtMC41IDAuMi0wLjcgMC4yIGMtMC4zIDAtMC41LTAuMS0wLjctMC4yYy0wLjItMC4xLTAuNC0wLjQtMC42LTAuN2MtMC4yLTAuMy0wLjItMC43LTAuMi0xYzAtMC41IDAuMS0wLjkgMC40LTEuNGMwLjItMC41IDAuNS0wLjggMC45LTEgYzAuMy0wLjIgMC43LTAuMyAxLTAuM2MwLjMgMCAwLjUgMC4xIDAuNyAwLjJjMC4yIDAuMSAwLjQgMC4zIDAuNiAwLjZsMC4xLTAuN2gwLjhsLTAuNiAyLjljLTAuMSAwLjQtMC4xIDAuNi0wLjEgMC43IGMwIDAuMSAwIDAuMSAwLjEgMC4yYzAuMSAwLjEgMC4xIDAuMSAwLjIgMC4xYzAuMiAwIDAuNC0wLjEgMC42LTAuM2MwLjMtMC4yIDAuNi0wLjUgMC44LTAuOWMwLjItMC40IDAuMy0wLjggMC4zLTEuMiBjMC0wLjUtMC4xLTAuOS0wLjQtMS4zYy0wLjItMC40LTAuNi0wLjgtMS4xLTFzLTEtMC40LTEuNi0wLjRjLTAuNyAwLTEuMyAwLjItMS44IDAuNWMtMC42IDAuMy0xIDAuOC0xLjMgMS40IGMtMC4zIDAuNi0wLjUgMS4yLTAuNSAxLjljMCAwLjcgMC4yIDEuMyAwLjUgMS44YzAuMyAwLjUgMC44IDAuOSAxLjMgMS4xYzAuNiAwLjIgMS4yIDAuNCAxLjkgMC40YzAuOCAwIDEuNC0wLjEgMS45LTAuNCBjMC41LTAuMyAwLjktMC42IDEuMS0wLjloMC44QzIyIDE0LjkgMjEuOCAxNS4zIDIxLjQgMTUuNnoiLz48L2c+PC9zdmc+" />
        <span class="sf-toolbar-status sf-toolbar-status-{{ color_code }}"></span>
        {% if collector.user %}<div class="sf-toolbar-status sf-toolbar-info-piece-additional">{{ collector.user }}</div>{% endif %}
    {% endset %}
    {% include '@WebProfiler/Profiler/toolbar_item.html.twig' with { 'link': profiler_url } %}
{% endblock %}

{% block menu %}
<span class="label">
    <span class="icon"><img width="42" height="30" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgNDIgMzAiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDQyIDMwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48Zz48cGF0aCBmaWxsPSIjM0YzRjNGIiBkPSJNMTYuMSAxNS4zYzAtMC41IDAtMC44IDAtMS4yYzAuMi0wLjEgMC42LTAuOCAwLjctMS40YzAuMiAwIDAuNC0wLjIgMC41LTAuOGMwLTAuNC0wLjEtMC41LTAuMi0wLjYgYzAuMy0wLjggMC44LTMuNC0xLjEtMy43QzE1LjcgNy4yIDE1LjIgNyAxNC42IDdjLTIuNiAwLTIuOSAyLTIuNCA0LjJjLTAuMSAwLjEtMC4zIDAuMy0wLjIgMC42YzAuMSAwLjcgMC4zIDAuOCAwLjUgMC44IGMwLjEgMC42IDAuNSAxLjMgMC43IDEuNGMwIDAuNCAwIDAuOCAwIDEuMmMtMC41IDEuNC00IDEtNC4yIDMuN2gxMS4yQzIwLjEgMTYuMyAxNi42IDE2LjcgMTYuMSAxNS4zeiIvPjxwYXRoIGZpbGw9IiMzRjNGM0YiIGQ9Ik0yOC4zIDEwLjJjLTAuMiAwLTAuNSAwLjEtMC43IDAuMmMtMC4yIDAuMS0wLjQgMC4zLTAuNiAwLjZjLTAuMiAwLjMtMC40IDAuNi0wLjUgMXMtMC4yIDAuNy0wLjIgMS4xIGMwIDAuNSAwLjEgMC45IDAuNCAxLjJzMC41IDAuNCAwLjggMC40YzAuMiAwIDAuNC0wLjEgMC43LTAuMmMwLjItMC4xIDAuNS0wLjMgMC43LTAuNnMwLjQtMC42IDAuNS0xYzAuMS0wLjQgMC4yLTAuOCAwLjItMS4yIGMwLTAuNS0wLjEtMC45LTAuNC0xLjJDMjkgMTAuMyAyOC43IDEwLjIgMjguMyAxMC4yeiIvPjxwYXRoIGZpbGw9IiMzRjNGM0YiIGQ9Ik0zNCA0SDdDNi40IDQgNiA0LjQgNiA1djE5YzAgMC42IDAuNCAxIDEgMWg1di0xYy0wLjYgMC0xLTAuNC0xLTFjMC0wLjYgMC40LTEgMS0xaDJjMC42IDAgMSAwLjQgMSAxIGMwIDAuNi0wLjQgMS0xIDF2MWgxM3YtMWMtMC42IDAtMS0wLjQtMS0xYzAtMC42IDAuNC0xIDEtMWgyYzAuNiAwIDEgMC40IDEgMWMwIDAuNi0wLjQgMS0xIDF2MWg1YzAuNiAwIDEtMC40IDEtMVY1IEMzNSA0LjQgMzQuNiA0IDM0IDR6IE0yMSAxOWMwIDAuNi0wLjQgMS0xIDFIOWMtMC42IDAtMS0wLjQtMS0xVjdjMC0wLjYgMC40LTEgMS0xaDExYzAuNiAwIDEgMC40IDEgMVYxOXogTTMyLjkgMTYuNiBjLTAuNSAwLjQtMSAwLjctMS43IDFjLTAuNiAwLjItMS40IDAuNC0yLjMgMC40Yy0wLjggMC0xLjYtMC4xLTIuMy0wLjNjLTAuNy0wLjItMS4zLTAuNS0xLjgtMWMtMC41LTAuNC0wLjktMC45LTEuMS0xLjUgYy0wLjMtMC43LTAuNS0xLjUtMC41LTIuM2MwLTAuOSAwLjItMS44IDAuNi0yLjZjMC41LTEgMS4xLTEuOCAyLTIuNEMyNi41IDcuMyAyNy42IDcgMjguOCA3YzAuOSAwIDEuOCAwLjIgMi41IDAuNiBjMC43IDAuNCAxLjMgMSAxLjggMS43YzAuNCAwLjcgMC42IDEuNCAwLjYgMi4xYzAgMS4xLTAuNCAyLjEtMS4yIDIuOWMtMC43IDAuOC0xLjQgMS4yLTIuMyAxLjJjLTAuMyAwLTAuNSAwLTAuNi0wLjEgYy0wLjItMC4xLTAuMy0wLjItMC40LTAuM2MwLTAuMS0wLjEtMC4zLTAuMS0wLjVjLTAuMiAwLjMtMC41IDAuNS0wLjggMC43Yy0wLjMgMC4yLTAuNiAwLjMtMC45IDAuM2MtMC4zIDAtMC43LTAuMS0xLTAuMyBjLTAuMy0wLjItMC42LTAuNS0wLjgtMC45Yy0wLjItMC40LTAuMy0wLjktMC4zLTEuM2MwLTAuNiAwLjItMS4yIDAuNS0xLjhjMC4zLTAuNiAwLjctMS4xIDEuMi0xLjRjMC41LTAuMyAwLjktMC41IDEuMy0wLjUgYzAuMyAwIDAuNiAwLjEgMC45IDAuM2MwLjMgMC4yIDAuNiAwLjQgMC44IDAuOGwwLjItMC45aDFsLTAuOCAzLjhjLTAuMSAwLjUtMC4yIDAuOC0wLjIgMC45YzAgMC4xIDAgMC4yIDAuMSAwLjMgYzAuMSAwLjEgMC4yIDAuMSAwLjMgMC4xYzAuMiAwIDAuNS0wLjEgMC44LTAuM2MwLjQtMC4zIDAuOC0wLjcgMS0xLjJjMC4zLTAuNSAwLjQtMSAwLjQtMS42YzAtMC42LTAuMi0xLjItMC41LTEuOCBjLTAuMy0wLjYtMC44LTEtMS41LTEuM3MtMS40LTAuNS0yLjEtMC41Yy0wLjkgMC0xLjcgMC4yLTIuNCAwLjZjLTAuNyAwLjQtMS4zIDEtMS43IDEuOEMyNC4yIDExIDI0IDExLjkgMjQgMTIuNyBjMCAwLjkgMC4yIDEuNyAwLjYgMi40YzAuNCAwLjcgMSAxLjIgMS44IDEuNWMwLjggMC4zIDEuNiAwLjUgMi41IDAuNWMxIDAgMS44LTAuMiAyLjUtMC41YzAuNy0wLjMgMS4yLTAuNyAxLjUtMS4yaDEgQzMzLjcgMTUuOCAzMy40IDE2LjIgMzIuOSAxNi42eiIvPjwvZz48L3N2Zz4=" alt="" /></span>
    <strong>Security</strong>
</span>
{% endblock %}

{% block panel %}
    <h2>Security</h2>
    {% if collector.user %}
        <table>
            <tr>
                <th>Username</th>
                <td>{{ collector.user }}</td>
            </tr>
            <tr>
                <th>Authenticated?</th>
                <td>
                    {% if collector.authenticated %}
                        yes
                    {% else %}
                        no {% if not collector.roles|length %}<em>(probably because the user has no roles)</em>{% endif %}
                    {% endif %}
                </td>
            </tr>
            <tr>
                <th>Roles</th>
                <td>{{ collector.roles|yaml_encode }}</td>
            </tr>
            {% if collector.supportsRoleHierarchy %}
            <tr>
                <th>Inherited Roles</th>
                <td>{{ collector.inheritedRoles|yaml_encode }}</td>
            </tr>
            {% endif %}
            {% if collector.tokenClass != null %}
            <tr>
                <th>Token class</th>
                <td>{{ collector.tokenClass }}</td>
            </tr>
            {% endif %}
        </table>
    {% elseif collector.enabled %}
        <p>
            <em>No token</em>
        </p>
    {% else %}
        <p>
            <em>The security component is disabled</em>
        </p>
    {% endif %}
{% endblock %}
