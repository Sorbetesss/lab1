{% extends '@WebProfiler/Profiler/layout.html.twig' %}

{% from _self import display_listener %}

{% block menu %}
<span class="label">
    <span class="icon"><img width="26" height="34" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAyNiAzNCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjYgMzQiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxwYXRoIGZpbGw9IiMzRjNGM0YiIGQ9Ik0xNS41IDE0LjhjMC41LTAuNiAwLjktMS40IDAuOS0yLjNjMC0xLjktMS41LTMuNC0zLjQtMy40cy0zLjQgMS41LTMuNCAzLjRjMCAwLjkgMC4zIDEuNyAwLjkgMi4zTDMuMiAzNCBoMi41bDAuNC0xLjFsNi44LTQuM2w2LjggNC4zbDAuNCAxLjFoMi41TDE1LjUgMTQuOHogTTE2IDIyLjZsLTIuMS0xbDEuNC0wLjdMMTYgMjIuNnogTTEzIDE2YzAuMSAwIDAuMyAwIDAuNCAwbDEuNiA0LjJsLTIgMSBsLTItMWwxLjYtNC4yQzEyLjcgMTUuOSAxMi45IDE2IDEzIDE2eiBNMTIuMSAyMS42bC0yLjEgMWwwLjYtMS43TDEyLjEgMjEuNnogTTcgMzAuN0w4LjggMjZsMi45IDEuOEw3IDMwLjd6IE05LjMgMjQuN2wwLjQtMSBMMTMgMjJsMy40IDEuN2wwLjQgMUwxMyAyN0w5LjMgMjQuN3ogTTE0LjMgMjcuOGwyLjktMS44bDEuOCA0LjdMMTQuMyAyNy44eiIvPjxnPjxwYXRoIGZpbGw9IiMzRjNGM0YiIGQ9Ik02LjIgNi4yYzAuNy0wLjcgMS43LTEuMSAyLjctMS4xdjEuM2MtMC43IDAtMS4zIDAuMi0xLjggMC43UzYuNCA4LjIgNi40IDguOUg1LjEgQzUuMSA3LjkgNS41IDYuOSA2LjIgNi4yeiIvPjxwYXRoIGZpbGw9IiMzRjNGM0YiIGQ9Ik0yLjUgOC45YzAtMS43IDAuNy0zLjMgMS45LTQuNXMyLjgtMS45IDQuNS0xLjlsMCAxLjNjLTEuNCAwLTIuNiAwLjUtMy42IDEuNVMzLjggNy41IDMuOCA4LjkgQzMuOCA4LjkgMi41IDguOSAyLjUgOC45eiIvPjxwYXRoIGZpbGw9IiMzRjNGM0YiIGQ9Ik01LjYgMC43QzYuNiAwLjIgNy43IDAgOC45IDBsMCAwdjEuM2MtMiAwLTQgMC44LTUuNCAyLjJTMS4zIDYuOSAxLjMgOC45SDBjMC0xLjIgMC4yLTIuMyAwLjctMy4zIGMwLjQtMS4xIDEuMS0yLjEgMi0yLjlTNC40IDEuMSA1LjYgMC43TDUuNiAwLjd6Ii8+PC9nPjxnPjxwYXRoIGZpbGw9IiMzRjNGM0YiIGQ9Ik0yMC45IDguOWgtMS4zYzAtMC43LTAuMi0xLjMtMC43LTEuOGMtMC41LTAuNS0xLjEtMC43LTEuOC0wLjdWNS4xYzEgMCAyIDAuNCAyLjcgMS4xIEMyMC41IDYuOSAyMC45IDcuOSAyMC45IDguOXoiLz48cGF0aCBmaWxsPSIjM0YzRjNGIiBkPSJNMjIuMiA4LjljMC0xLjQtMC41LTIuNi0xLjUtMy42Yy0xLTEtMi4yLTEuNS0zLjYtMS41VjIuNWMxLjcgMCAzLjMgMC43IDQuNSAxLjlzMS45IDIuOCAxLjkgNC41IEMyMy41IDguOSAyMi4yIDguOSAyMi4yIDguOXoiLz48cGF0aCBmaWxsPSIjM0YzRjNGIiBkPSJNMjAuNSAwLjdjMS4xIDAuNCAyLjEgMS4xIDIuOSAyczEuNSAxLjggMiAyLjlDMjUuOCA2LjYgMjYgNy43IDI2IDguOWgtMS4zYzAtMi0wLjgtNC0yLjItNS40IHMtMy40LTIuMi01LjQtMi4yVjBsMCAwQzE4LjMgMCAxOS40IDAuMiAyMC41IDAuN0wyMC41IDAuN3oiLz48L2c+PC9nPjwvc3ZnPg==" alt="Events"></span>
    <strong>Events</strong>
</span>
{% endblock %}

{% block panel %}
    {% if collector.calledlisteners|length %}
        {{ block('panelContent') }}
    {% else %}
        <h2>Events</h2>
        <p>
            <em>No events have been recorded. Are you sure that debugging is enabled in the kernel?</em>
        </p>
    {% endif %}
{% endblock %}

{% block panelContent %}
    <h2>Called Listeners</h2>

    <table>
        <tr>
            <th>Event name</th>
            <th>Listener</th>
        </tr>
        {% for listener in collector.calledlisteners %}
            <tr>
                <td><code>{{ listener.event }}</code></td>
                <td><code>{{ display_listener(listener) }}</code></td>
            </tr>
        {% endfor %}
    </table>

    <h2>Not Called Listeners</h2>

    {% if collector.notcalledlisteners %}
        <table>
            <tr>
                <th>Event name</th>
                <th>Listener</th>
            </tr>
            {% set listeners = collector.notcalledlisteners %}
            {% for listener in listeners|keys|sort %}
                <tr>
                    <td><code>{{ listeners[listener].event }}</code></td>
                    <td><code>{{ display_listener(listeners[listener]) }}</code></td>
                </tr>
            {% endfor %}
        </table>
    {% else %}
        <p>
            <strong>No uncalled listeners</strong>.
        </p>
        <p>

            All listeners were called for this request or an error occurred
            when trying to collect uncalled listeners (in which case check the
            logs to get more information).

        </p>
    {% endif %}
{% endblock %}

{% macro display_listener(listener) %}
    {% if listener.type == "Closure" %}
        Closure
    {% elseif listener.type == "Function" %}
        {% set link = listener.file|file_link(listener.line) %}
        {% if link %}<a href="{{ link }}">{{ listener.function }}</a>{% else %}{{ listener.function }}{% endif %}
    {% elseif listener.type == "Method" %}
        {% set link = listener.file|file_link(listener.line) %}
        {{ listener.class|abbr_class }}::{% if link %}<a href="{{ link }}">{{ listener.method }}</a>{% else %}{{ listener.method }}{% endif %}
    {% endif %}
{% endmacro %}
