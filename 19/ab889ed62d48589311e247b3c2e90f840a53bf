---------------------------------------------------------------------------

by stof at 2018-07-04T07:45:51Z

this needs tests

---------------------------------------------------------------------------

by nicolas-grekas at 2018-07-04T09:36:19Z

now tested
